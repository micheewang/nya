<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>nya</title>
  </head>

  <body>
    <div id="root"></div>
  </body>
  <script>
    console.log(nya);
    const { TAG, createComponent, createTruck, renderDOM, useChapter } = nya;

    let { Div, Button } = TAG;

    let store = {
      idx: 0,
    };
    let truck = createTruck();
    truck.setAnswer(function () {
      this.send(store);
    });
    truck.setReceive(function (newStore) {
      store = newStore;
    });

    //extends
    let Component1 = createComponent(() => {
      let [getValue, setValue] = useChapter({ idx: 0 });
      truck.setReceive(function (data) {
        setValue(data);
      });

      function onclick() {
        truck.send({ idx: getValue().idx + 1 });
      }

      return ({ slot, props }) => {
        var value = getValue();
        return Div({ title: props.title }, [
          Div('this is the ' + value.idx + ' children.'),
          slot[0],
          slot[1],
          slot[2],
          slot[3] && Button({ onclick }, slot[3]),
        ]);
      };
    });

    let Component2 = createComponent(() => {
      return ({ slot }) => Div([slot[0]]);
    });

    // string slot | props | element slot
    let demo2 = Div({ title: 'outer-div' }, [
      Component1(
        {
          title: 'test props',
        },
        [
          'test string slot',
          Div('test element slot'),
          Component2(' test componet slot'),
          '点击我',
        ]
      ),
      Component1({
        title: 'test props',
      },['this is the different component']),
    ]);
    console.log(demo2);

    renderDOM(demo2, document.getElementById('root'));
  </script>
</html>
